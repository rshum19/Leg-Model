function [D,h,G,B] = Eval_Stance_DynFunc(X)

th1 = X(1);
th2 = X(2);
th3 = X(3);
l1 = X(4);
dth1 = X(5);
dth2 = X(6);
dth3 = X(7);
dl1 = X(8);
g = 9.81;

D = [ (7777*l1^2)/160 - (891*l1^2*cos(2*th1))/32 + 33/50, (132*l1*cos(th1 - th2))/25,   3*l1*cos(th1 - th3),        -(891*l1*sin(2*th1))/32;...
                         (132*l1*cos(th1 - th2))/25,                  1797/1000, (9*cos(th2 - th3))/10,        (132*sin(th1 - th2))/25;...
                                3*l1*cos(th1 - th3),      (9*cos(th2 - th3))/10,                93/100,               3*sin(th1 - th3);...
                            -(891*l1*sin(2*th1))/32,    (132*sin(th1 - th2))/25,      3*sin(th1 - th3), (891*cos(2*th1))/32 + 7777/160];
 

h = [  (l1*(77770*dl1*dth1 + 4224*dth2^2*sin(th1 - th2) + 2400*dth3^2*sin(th1 - th3) - 44550*dl1*dth1*cos(2*th1) + 22275*dth1^2*l1*sin(2*th1)))/800;...
                                              (9*sin(th2 - th3)*dth3^2)/10 + (264*dl1*dth1*cos(th1 - th2))/25 - (132*dth1^2*l1*sin(th1 - th2))/25;...
                                                          - 3*l1*sin(th1 - th3)*dth1^2 + 6*dl1*cos(th1 - th3)*dth1 - (9*dth2^2*sin(th2 - th3))/10;...
 - 3*cos(th1 - th3)*dth3^2 - (132*dth2^2*cos(th1 - th2))/25 - (7777*dth1^2*l1)/160 - (891*dl1*dth1*sin(2*th1))/16 - (891*dth1^2*l1*cos(2*th1))/32];
                          
G = [ -(629*g*l1*sin(th1))/20;...
    -(132*g*sin(th2))/25;...
           -3*g*sin(th3);...
     (629*g*cos(th1))/20];
 
B = [ 0, 0, 0;...
      0, 0, 0;...
      0, 0, 0;...
      1, 0, 0];
end